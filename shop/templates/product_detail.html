{% extends 'base.html' %}

{% block content %}
<div class="container mt-4 mb-5">
  <div class="row">
    <!-- Product Image -->
    <div class="col-lg-6 mb-4">
      {% if product.image %}
        <img src="{{ product.image.url }}" class="img-fluid product-detail-img" alt="{{ product.title }}">
      {% else %}
        <img src="https://placehold.co/600x600/cccccc/ffffff?text=Product+Image" class="img-fluid product-detail-img" alt="{{ product.title }}">
      {% endif %}
    </div>
    
    <!-- Product Details -->
    <div class="col-lg-6">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="{% url 'shop:home_page' %}">Home</a></li>
          <li class="breadcrumb-item"><a href="{% url 'shop:filter_by_category' product.category.slug %}">{{ product.category }}</a></li>
          <li class="breadcrumb-item active" aria-current="page">{{ product.title }}</li>
        </ol>
      </nav>
      
      <h1 class="product-detail-title">{{ product.title }}</h1>
      
      <div class="mb-3">
        <span class="product-detail-price">₹{{ product.price }}</span>
      </div>
      
      <p class="text-muted">
        <i class="fas fa-tag me-1"></i> Category: 
        <a href="{% url 'shop:filter_by_category' product.category.slug %}" class="text-decoration-none">
          {{ product.category }}
        </a>
      </p>
      
      <div class="border-top pt-3 mt-3">
        <h5>Description</h5>
        <p>{{ product.description }}</p>
      </div>
      
      <!-- Add to Cart Form -->
      <form method="post" action="{% url 'cart:add_to_cart' product.id %}" class="mt-4">
        {% csrf_token %}
        <div class="row">
          <div class="col-md-4 mb-3">
            <label for="quantity" class="form-label">Quantity</label>
            {{ form }}
          </div>
        </div>
        <button type="submit" class="btn btn-primary btn-lg">
          <i class="fas fa-shopping-cart me-2"></i>Add to Cart
        </button>
      </form>
      
      <!-- Wishlist Button -->
      <div class="mt-3">
        {% if favorites == 'remove' %}
          <a href="{% url 'shop:remove_from_favorites' product.id %}" class="btn btn-outline-danger">
            <i class="fas fa-heart me-2"></i>Remove from Wishlist
          </a>
        {% else %}
          <a href="{% url 'shop:add_to_favorites' product.id %}" class="btn btn-outline-primary">
            <i class="far fa-heart me-2"></i>Add to Wishlist
          </a>
        {% endif %}
      </div>
    </div>
  </div>
  
  <!-- Related Products -->
  {% if related_products %}
  <div class="row mt-5">
    <div class="col-12">
      <h3 class="mb-4">Related Products</h3>
    </div>
    
    {% for p in related_products %}
      {% if p != product %}
      <div class="col-lg-3 col-md-4 col-sm-6">
        <div class="card product-card">
          {% if p.image %}
            <img src="{{ p.image.url }}" class="card-img-top product-img" alt="{{ p.title }}">
          {% else %}
            <img src="https://placehold.co/300x300/cccccc/ffffff?text=Product+Image" class="card-img-top product-img" alt="{{ p.title }}">
          {% endif %}
          <div class="card-body text-center">
            <h5 class="product-title">{{ p.title }}</h5>
            <p class="product-price">₹{{ p.price }}</p>
            <a href="{{ p.get_absolute_url }}" class="btn btn-primary btn-add-to-cart">Buy Now</a>
          </div>
        </div>
      </div>
      {% endif %}
    {% endfor %}
  </div>
  {% endif %}
</div>
{% endblock %}